---
layout: page
title: APIs.json Annotation
---
<style>
    input[type=text] {
     width: 100%;
     padding: 15px 8px 15px 8px;
    }
    input[type=email] {
     width: 100%;
     padding: 15px 8px 15px 8px;
    }
    textarea {
        width: 100%;
        height: 150px;
    }

    .specListing{

    }
    .pathname{
      font-size: 11px;
    }
    .method{
      font-size: 11px;
    }
</style>

<h1>APIs.json Annotation - 4</h1>
<p>This is an exmple of autocomplete done client side with <a href="/apis.json">this projects APIs.json</a>, providing access to the paths, verbs, and tags contained within an APIs.json collection.</p>
<script type="text/jscript">

var $apiurl = "";
var $Pallette = {};
var $FullCount = 0;
var $pathArray = [];
var $verbArray = [];
var $tagArray = [];

function addMessageField()
  {
  $html = '<table border="1">';
  $html = $html + '<tr>';
  $html = $html + '<td colspan="3">';
  $html = $html + '<input type="text" name="message" id="message" style="width: 100%;" />';
  $html = $html + '<input type="button" name="addmessage" value="add" />';
  $html = $html + '</td>';
  $html = $html + '</tr>';
  $html = $html + '</table>';
  $('#specMessenger').append($html);
  }

function processAPIsJSON($apisjsonURL)
{

  $apiHumanURL = "";

  $html = '<table width="100%" id="specListing">';
  $('#specViewer').append($html);

  $FullCount = $FullCount + 1;

  var loadIt = $.getJSON($apisjsonURL, function($apisJSON) {

    $masterName = $apisJSON['name'];
    //$html = '<p><strong>' + $masterName + '</strong></p>';
    //$('#specViewer').append($html);

    $masterDesc = $apisJSON['description'];
    $masterLogo = $apisJSON['image'];
    $masterURL = $apisJSON['url'];
    $masterTags = $apisJSON['tags'];

    $.each($apisJSON['apis'], function(apiKey, apiVal) {

      $apiName = apiVal['name'];
      $html = '<tr><td colspan="3">';
      $html = $html + '<strong>' + $apiName + '</strong><br />';
      $html = $html + '</td></tr>';
      $('#specViewer').append($html);

      $apiHumanURL = apiVal['humanURL'];
      $apiBaseURL = apiVal['baseURL'];

      $apiProperties = apiVal['properties'];

      $.each($apiProperties, function(propertyKey, propertyValue) {

        $type = propertyValue['type'];
        $url = propertyValue['url'];

        if($type=='x-openapi-spec')
          {

          $FullCount = $FullCount + 1;

          if(!$url.indexOf('http') > -1)
            {
            $baseSite = $apisJSON['url'].replace('apis.json','');
            $pull_url = $baseSite + $url;
            }
          else
            {
            $pull_url = $url;
            }

          var loadIt3 = $.getJSON($pull_url, function($openapispec) {

            $paths = $openapispec['paths'];
            $title = $openapispec['info']['title'];

            $apiSlug = $title.replace(/ /g,"-");
            $apiSlug = $apiSlug.toLowerCase();

            // show the unique host
            $host = $openapispec['host'];
            $basepath = $openapispec['basePath'];

            $html = '<tr><td colspan="3"><strong>Host:</strong> ' + $host + '</td></tr>';
            $('#specViewer').append($html);

            $html = '<tr><td colspan="3"><strong>Base Path:</strong> ' + $basepath + '</td></tr>';
            $('#specViewer').append($html);

            $.each($paths, function(pathKey, pathValue) {

              $path_name = pathKey;

              $pathexist = 0;
              $.each($verbArray, function(key, value) {if(value == $path_name){ $pathexist = 1; }});
              if($pathexist==0) {  $pathArray.push($path_name); }

              $.each(pathValue, function(methodKey, methodValue) {

                $method = methodKey;
                $method = $method.toUpperCase();

                $html = '<tr>';
                $html = $html + '<td class="pathname">' + $path_name + '</td>';
                $html = $html + '<td class="method" width="35">(' + $method + ')</td>';
                $html = $html + '<td width="50"><a href="" onclick="addMessageField(); return: false;"<img src="https://s3.amazonaws.com/kinlane-productions/bw-icons/bw-messaging-system.png" width="25" /></a></td>';
                $html = $html + '</tr>';
                //console.log($html);
                $('#specViewer').append($html);

                $methodexist = 0;
                $.each($verbArray, function(key, value) { if(value == $method){ $methodexist = 1; }});
                if($methodexist==0) { $verbArray.push($method); }

                $method_summary = methodValue['summary'];
                $tags = methodValue['tags'];

                $.each($tags, function($tagKey, $tagValue) {

                  $tag = $tagValue;
                  $tag = $tag.trim();
                  $tagslug = $tag.replace(/ /g,"-");
                  $tagslug = $tagslug.toLowerCase();
                  $tag = $tag.charAt(0).toUpperCase() + $tag.slice(1);

                  $tagexists = 0;
                  $.each($tagArray, function(key, value) { if(value == $tag){ $tagexists = 1; } });
                  if($tagexists==0) { $tagArray.push($tag);  }

                });
              });
            });


          });

          loadIt3.complete(function() {

            $FullCount = $FullCount - 1;
            if($FullCount==0){

              // Load What We Want
              $(function() {

                // Do Something

              });
            }
          });
        }
      });
    });
  });

  $html = '</table>';
  $('#specViewer').append($html);

}

$apisjsonURL = "/apis.json";
processAPIsJSON($apisjsonURL);

</script>

<table width="100%" cellpadding="2" cellspacing="2" border"1">
  <tr>
    <td width="82%" valign="top" id="specViewer"></td>
    <td width="18%" valign="top" id="specMessenger"></td>
  </tr>
</table>

<p>I am just exploring different ways of working with the surface area of an API, using machine readable API definitions like APIs.json and OpenAPI Spec.</p>
